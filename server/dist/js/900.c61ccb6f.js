"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[900],{6095:function(e,t,a){a.r(t),a.d(t,{default:function(){return We}});var s=a(6768),l=a(4232),o=a(5130);const i={class:"page-wrapper"},d={class:"main-container"},n={class:"content-wrapper-scroll"},r={class:"content-wrapper"},u={class:"row"},c={class:"col-12"},m={class:"card"},h={class:"card-body"},p={class:"row mb-2"},_={class:"col-md-4"},k=(0,s.Lk)("label",null,"Selecione o Ano",-1),b=(0,s.Lk)("br",null,null,-1),f=(0,s.Lk)("option",{value:""},"Todos os Anos",-1),L=["value"],g={class:"col-md-4"},v=(0,s.Lk)("label",null,"Selecione o Curso",-1),E=(0,s.Lk)("br",null,null,-1),w=(0,s.Lk)("option",{value:""},"Todos os Cursos",-1),C=["value"],y={class:"col-md-4"},x=(0,s.Lk)("label",null,"Selecione o Periodo",-1),M=(0,s.Lk)("br",null,null,-1),F=(0,s.Lk)("option",{value:""},"Todos os Períodos",-1),$=["value"],S={class:"col-md-4"},A=(0,s.Lk)("label",null,"Selecione a Classe",-1),T=(0,s.Lk)("br",null,null,-1),X=(0,s.Lk)("option",{value:""},"Todas as Classes",-1),I=["value"],N={class:"col-md-4"},P=(0,s.Lk)("label",null,"Selecione a Turma",-1),H=(0,s.Lk)("br",null,null,-1),O=(0,s.Lk)("option",{value:""},"Todas as Turmas",-1),V=["value"],W={class:"col-md-4"},R={class:"d-flex"},U=(0,s.Lk)("label",{class:"text-white"},".",-1),K=(0,s.Lk)("br",null,null,-1),B=(0,s.Lk)("span",{style:{"font-size":"22px"},class:"fas fa-search mx-1"},null,-1),D=(0,s.Lk)("label",{class:"text-white"},".",-1),q=(0,s.Lk)("br",null,null,-1),j=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{class:"bg-secondary"},[(0,s.Lk)("th",null,"NOME"),(0,s.Lk)("th",null,"IDENTIFICAÇÃO"),(0,s.Lk)("th",null,"TELEFONE"),(0,s.Lk)("th",null,"CURSO")])],-1),z={class:"modal fade","data-bs-backdrop":"static",id:"registrationMultiple"},Q={class:"modal-dialog modal-xl rounded-0"},J={class:"modal-content rounded-0"},Z={class:"modal-header"},G=(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Y={class:"modal-body"},ee={class:"row"},te={class:"col-md-6"},ae=(0,s.Lk)("h5",null,"Selecione os Estudantes",-1),se={style:{"max-height":"300px","overflow-y":"auto",border:"1px solid #eee",padding:"10px"}},le={class:"table table-striped table-sm"},oe=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Sel."),(0,s.Lk)("th",null,"Nome"),(0,s.Lk)("th",null,"Identificação")])],-1),ie=["value"],de={key:0},ne=(0,s.Lk)("td",{colspan:"3",class:"text-center"},"Nenhum estudante encontrado.",-1),re=[ne],ue={class:"col-md-6"},ce={style:{"max-height":"300px","overflow-y":"auto",border:"1px solid #007bff",padding:"10px"}},me={class:"list-group"},he=["onClick"],pe={key:0,class:"list-group-item text-center text-muted"},_e={class:"modal-footer border-0 pt-0"},ke=(0,s.Lk)("button",{class:"btn btn-secondary rounded-0","data-bs-dismiss":"modal"},"Fechar",-1),be=["disabled"],fe={class:"modal fade","data-bs-backdrop":"static",id:"cancelRegistration"},Le={class:"modal-dialog rounded-0"},ge={class:"modal-content rounded-0"},ve={class:"modal-header"},Ee={class:"modal-body"},we={class:"row"},Ce={class:"modal-footer border-0 pt-0"},ye=(0,s.Lk)("button",{class:"btn btn-secondary rounded-0","data-bs-dismiss":"modal"},"Fechar",-1);function xe(e,t,a,ne,xe,Me){const Fe=(0,s.g2)("Sidebar"),$e=(0,s.g2)("Navbar"),Se=(0,s.g2)("DataTable"),Ae=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.bF)(Fe),(0,s.Lk)("div",d,[(0,s.bF)($e,{page:"Secretaria / Estudantes Matriculados"}),(0,s.Lk)("div",n,[(0,s.Lk)("div",r,[(0,s.Lk)("div",u,[(0,s.Lk)("div",c,[(0,s.Lk)("div",m,[(0,s.Lk)("div",h,[(0,s.Lk)("div",p,[(0,s.Lk)("div",_,[k,b,(0,s.bo)((0,s.Lk)("select",{class:"form-select","onUpdate:modelValue":t[0]||(t[0]=e=>xe.filter_data.ano_id=e)},[f,(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(xe.anos,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nome),9,L)))),128))],512),[[o.u1,xe.filter_data.ano_id]])]),(0,s.Lk)("div",g,[v,E,(0,s.bo)((0,s.Lk)("select",{class:"form-select","onUpdate:modelValue":t[1]||(t[1]=e=>xe.filter_data.curso_id=e),onChange:t[2]||(t[2]=(...e)=>Me.getSalas&&Me.getSalas(...e))},[w,(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(xe.cursos,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nome),9,C)))),128))],544),[[o.u1,xe.filter_data.curso_id]])]),(0,s.Lk)("div",y,[x,M,(0,s.bo)((0,s.Lk)("select",{class:"form-select","onUpdate:modelValue":t[3]||(t[3]=e=>xe.filter_data.periodo_id=e),onChange:t[4]||(t[4]=(...e)=>Me.getSalas&&Me.getSalas(...e))},[F,(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(xe.periodos,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nome),9,$)))),128))],544),[[o.u1,xe.filter_data.periodo_id]])]),(0,s.Lk)("div",S,[A,T,(0,s.bo)((0,s.Lk)("select",{class:"form-select","onUpdate:modelValue":t[5]||(t[5]=e=>xe.filter_data.classe_id=e),onChange:t[6]||(t[6]=(...e)=>Me.getSalas&&Me.getSalas(...e))},[X,(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(xe.classes,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nome),9,I)))),128))],544),[[o.u1,xe.filter_data.classe_id]])]),(0,s.Lk)("div",N,[P,H,(0,s.bo)((0,s.Lk)("select",{class:"form-select","onUpdate:modelValue":t[7]||(t[7]=e=>xe.filter_data.sala_id=e)},[O,(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(xe.salas,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nome),9,V)))),128))],512),[[o.u1,xe.filter_data.sala_id]])]),(0,s.Lk)("div",W,[(0,s.Lk)("div",R,[(0,s.Lk)("div",null,[U,K,(0,s.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>Me.getMatriculados&&Me.getMatriculados(...e)),class:"btn btn-primary btn-sm mx-1 fw-bold d-flex align-items-center p-2 border-0 text-uppercase"},[B,(0,s.eW)(" Pesquisar ")])]),(0,s.Lk)("div",null,[D,q,(0,s.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>Me.getEstudantes&&Me.getEstudantes(...e)),style:{color:"black"},class:"btn btn-warning btn-sm mx-1 fw-bold d-flex align-items-center p-2 border-0 text-uppercase","data-bs-toggle":"modal","data-bs-target":"#registrationMultiple"}," Matricular Vários ")])])])]),(0,s.bF)(Se,{ref:"table",data:xe.matriculados,columns:xe.columns,options:{select:!1,language:xe.language},class:"display table table-striped table-bordered"},{default:(0,s.k6)((()=>[j])),_:1},8,["data","columns","options"])])])])]),(0,s.Lk)("div",z,[(0,s.Lk)("div",Q,[(0,s.Lk)("div",J,[(0,s.Lk)("div",Z,[(0,s.Lk)("h4",null,"Matricular Vários Estudantes ("+(0,l.v_)(xe.selected_estudantes.length)+")",1),G]),(0,s.Lk)("div",Y,[(0,s.Lk)("div",ee,[(0,s.Lk)("div",te,[ae,(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control mb-3","onUpdate:modelValue":t[10]||(t[10]=e=>xe.search_estudante=e),onInput:t[11]||(t[11]=(...t)=>e.filterEstudantesList&&e.filterEstudantesList(...t)),placeholder:"Pesquisar Estudantes (Nome ou Identificação)"},null,544),[[o.Jo,xe.search_estudante]]),(0,s.Lk)("div",se,[(0,s.Lk)("table",le,[oe,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Me.filtered_estudantes,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[12]||(t[12]=e=>xe.selected_estudantes=e)},null,8,ie),[[o.lH,xe.selected_estudantes]])]),(0,s.Lk)("td",null,(0,l.v_)(e.nome),1),(0,s.Lk)("td",null,(0,l.v_)(e.identificacao),1)])))),128)),0===xe.estudantes.length?((0,s.uX)(),(0,s.CE)("tr",de,re)):(0,s.Q3)("",!0)])])])]),(0,s.Lk)("div",ue,[(0,s.Lk)("h5",null,"Estudantes a Matricular ("+(0,l.v_)(Me.selectedEstudantesList.length)+")",1),(0,s.Lk)("div",ce,[(0,s.Lk)("ul",me,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Me.selectedEstudantesList,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"list-group-item d-flex justify-content-between align-items-center py-1 px-2"},[(0,s.eW)((0,l.v_)(e.nome)+" ",1),(0,s.Lk)("span",{class:"badge bg-danger rounded-pill",style:{cursor:"pointer"},onClick:t=>Me.removeSelected(e.id)}," X ",8,he)])))),128)),0===Me.selectedEstudantesList.length?((0,s.uX)(),(0,s.CE)("li",pe," Nenhum estudante selecionado. ")):(0,s.Q3)("",!0)])])])])]),(0,s.Lk)("div",_e,[ke,(0,s.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>Me.matricularMultiplos&&Me.matricularMultiplos(...e)),disabled:0===xe.selected_estudantes.length||!xe.filter_data.ano_id||!xe.filter_data.curso_id||!xe.filter_data.sala_id||!xe.filter_data.periodo_id||!xe.filter_data.classe_id,class:"btn btn-primary rounded-0"}," Confirmar Matrículas ( "+(0,l.v_)(xe.selected_estudantes.length)+" ) ",9,be)])])])]),(0,s.Lk)("div",fe,[(0,s.Lk)("div",Le,[(0,s.Lk)("div",ge,[(0,s.Lk)("div",ve,[(0,s.Lk)("h4",null,(0,l.v_)(xe.title),1)]),(0,s.Lk)("div",Ee,[(0,s.Lk)("div",we,[(0,s.Lk)("p",null,[(0,s.eW)(" Deseja **remover permanentemente** esta matrícula de "),(0,s.Lk)("b",null,(0,l.v_)(xe.matricula.Estudante?xe.matricula.Estudante.nome:"o estudante"),1),(0,s.eW)("? Esta ação é irreversível. ")])])]),(0,s.Lk)("div",Ce,[ye,(0,s.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>Me.removerMatricula&&Me.removerMatricula(...e)),class:"btn btn-danger rounded-0"},"Remover Matrícula")])])])])]),(0,s.bF)(Ae)])])])}var Me=a(6587),Fe=a.n(Me),$e=a(3362),Se=a(8808),Ae=a(6313),Te=a(9715),Xe=a(903),Ie=a(9995),Ne=a(3786),Pe=a(782);Xe.A.use(Ie.A),Xe.A.use(Ne.A);var He={name:"matricula_view",components:{Sidebar:$e.A,Navbar:Se.A,Footer:Ae.A,DataTable:Xe.A},data(){return{title:"Matrícula",dataTable:null,selectedRow:null,matriculados:[],estudantes:[],selected_estudantes:[],anos:[],cursos:[],periodos:[],salas:[],classes:[],search_estudante:"",estados:["Estudando","Cancelada","Transita","Não Transita"],matricula:{id:null,Estudante:{},estudante_id:""},filter_data:{ano_id:"",curso_id:"",sala_id:"",periodo_id:"",classe_id:""},columns:[{data:null,render:e=>null===e.Estudante?"Não definido":e.Estudante.nome},{data:null,render:e=>null===e.Estudante?"Não definido":e.Estudante.identificacao},{data:null,render:e=>null===e.Estudante?"Não definido":e.Estudante.telefone},{data:null,render:e=>`${e.Curso.nome}`}],language:Te.BH}},mounted(){this.getEstudantes(),this.getAnos(),this.getCursos(),this.getPeriodos(),this.getClasses()},methods:{hideBootstrapModal(e){const t=document.getElementById(e);if(t&&window.bootstrap&&window.bootstrap.Modal){const e=window.bootstrap.Modal.getInstance(t)||new window.bootstrap.Modal(t);e.hide()}else console.warn(`Bootstrap Modal JS API não encontrada ou modal #${e} não existe. Tentando jQuery.`),"undefined"!==typeof Fe()&&Fe().fn.modal&&Fe()(`#${e}`).modal("hide")},removeSelected(e){const t=this.selected_estudantes.indexOf(e);t>-1&&this.selected_estudantes.splice(t,1)},async matricularMultiplos(){if(!this.filter_data.ano_id||!this.filter_data.curso_id||!this.filter_data.sala_id||!this.filter_data.periodo_id||!this.filter_data.classe_id)return void this.$swal.fire({title:"Erro de Filtro",icon:"error",text:"Por favor, selecione **Ano, Curso, Período, Classe e Turma** para realizar as matrículas."});if(0===this.selected_estudantes.length)return void this.$swal.fire({title:"Atenção",icon:"warning",text:"Selecione pelo menos um estudante para matricular."});const e=this.selected_estudantes.map((e=>({ano_id:this.filter_data.ano_id,curso_id:this.filter_data.curso_id,sala_id:this.filter_data.sala_id,periodo_id:this.filter_data.periodo_id,classe_id:this.filter_data.classe_id,estudante_id:e,user_id:this.user.id,estado:"Estudando"}))),t={matriculas:e,user_id:this.user.id,nome:this.user.nome};try{const e=await Te.FH.post("/matricula/multiple",t),a=e.data.message||`${this.selected_estudantes.length} Matrícula(s) realizada(s) com sucesso.`;this.$swal.fire({title:"Sucesso!",icon:"success",text:a}),this.selected_estudantes=[],this.hideBootstrapModal("registrationMultiple"),this.getMatriculados()}catch(a){console.error("ERRO COMPLETO na Matrícula Múltipla:",a);const e=a.response?.data?.message||"Erro ao matricular estudantes. Verifique o console.";this.$swal.fire({title:"Erro na Matrícula",icon:"error",text:e})}},async removerMatricula(){try{const e={user_id:this.user.id,nome:this.user.nome},t=await Te.FH.delete(`/matricula/${this.matricula.id}`,{data:e});this.$swal.fire({title:t.data.message,icon:"success"}),this.getMatriculados(),this.hideBootstrapModal("cancelRegistration"),this.clearForm()}catch(e){const t=e.response?.data?.message||"Erro: Não foi possível excluir a matrícula.";this.$swal.fire({title:t,icon:"error"}),console.error("Erro ao remover matrícula:",e.response.data)}},getSalas(){const{periodo_id:e,curso_id:t,classe_id:a}=this.filter_data;if(!e||!t||!a)return this.salas=[],void(this.filter_data.sala_id="");Te.FH.get(`/salas/curso/${t}/classe/${a}/periodo/${e}`).then((e=>{this.salas=e.data,0===this.salas.length&&(this.filter_data.sala_id="")})).catch((e=>{console.error("Erro ao carregar salas:",e),this.salas=[],this.filter_data.sala_id=""}))},generatePDF(){const{ano_id:e,curso_id:t,periodo_id:a,classe_id:s,sala_id:l}=this.filter_data;e&&t&&a&&s&&l?window.open(`${Te.OZ}/api/documentos/lista-matriculados/ano/${e}/curso/${t}/periodo/${a}/classe/${s}/sala/${l}`,"_blank"):this.$swal.fire({title:"Filtros Incompletos",icon:"warning",text:"Por favor, selecione Ano, Curso, Período, Classe e Turma antes de gerar o PDF."})},getMatriculados(){const{ano_id:e,sala_id:t}=this.filter_data;if(!e||!t)return this.$swal.fire({title:"Filtros Obrigatórios",icon:"warning",text:"Por favor, selecione o Ano e a Turma para pesquisar os estudantes matriculados."}),void(this.matriculados=[]);Te.FH.get(`/matricula/ano/${e}/turma/${t}/`).then((e=>{e.data&&e.data.length>0?this.matriculados=e.data:(this.matriculados=[],this.$swal.fire({title:"Notificação",icon:"warning",text:"Nenhum Estudante Matriculado Encontrado com os filtros selecionados."})),this.clearForm()})).catch((e=>{console.log(e),this.matriculados=[]}))},getEstudantes(){Te.FH.get("/estudantes/").then((e=>{this.estudantes=e.data,this.selected_estudantes=[],this.search_estudante=""})).catch((e=>{console.log(e)}))},getAnos(){Te.FH.get("/anos/status/1/").then((e=>{this.anos=e.data})).catch((e=>{console.log(e)}))},getCursos(){Te.FH.get("/cursos/").then((e=>{this.cursos=e.data})).catch((e=>{console.log(e)}))},getClasses(){Te.FH.get("/classes/").then((e=>{this.classes=e.data})).catch((e=>{console.log(e)}))},getPeriodos(){Te.FH.get("/periodos/").then((e=>{this.periodos=e.data})).catch((e=>{console.log(e)}))},selectRow(){const e=this.$refs.table.dt;this.matricula={id:null,Estudante:{}};const t=e.rows({selected:!0}).data();t.length>0&&(this.matricula=t[0])},clearForm(){this.matricula={id:null,Estudante:{},estudante_id:""},this.$refs.table&&this.$refs.table.dt&&this.$refs.table.dt.rows().deselect()}},computed:{...(0,Pe.aH)(["user"]),selectedEstudantesList(){return this.estudantes.filter((e=>this.selected_estudantes.includes(e.id)))},filtered_estudantes(){const e=this.search_estudante.toLowerCase().trim();return e?this.estudantes.filter((t=>{const a=(t.nome||"").toLowerCase(),s=(t.identificacao||"").toLowerCase();return a.includes(e)||s.includes(e)})):this.estudantes}}},Oe=a(1241);const Ve=(0,Oe.A)(He,[["render",xe]]);var We=Ve}}]);
//# sourceMappingURL=900.c61ccb6f.js.map