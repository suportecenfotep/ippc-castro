"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[385],{8680:function(e,t,a){a.r(t),a.d(t,{default:function(){return Ke}});var s=a(6768),l=a(4232),o=a(5130);const d={class:"page-wrapper"},i={class:"main-container"},n={class:"content-wrapper-scroll"},r={class:"content-wrapper"},c={class:"row"},u={class:"col-12"},m={class:"card"},h={class:"card-body"},p={class:"row mb-2"},k={class:"col-md-4"},_=(0,s.Lk)("label",null,"Selecione o Ano",-1),b=(0,s.Lk)("br",null,null,-1),f=(0,s.Lk)("option",{value:""},"Todos os Anos",-1),g=["value"],L={class:"col-md-4"},v=(0,s.Lk)("label",null,"Selecione o Curso",-1),E=(0,s.Lk)("br",null,null,-1),w=(0,s.Lk)("option",{value:""},"Todos os Cursos",-1),C=["value"],x={class:"col-md-4"},y=(0,s.Lk)("label",null,"Selecione o Periodo",-1),F=(0,s.Lk)("br",null,null,-1),M=(0,s.Lk)("option",{value:""},"Todos os Períodos",-1),$=["value"],S={class:"col-md-4"},A=(0,s.Lk)("label",null,"Selecione a Classe",-1),T=(0,s.Lk)("br",null,null,-1),X=(0,s.Lk)("option",{value:""},"Todas as Classes",-1),I=["value"],N={class:"col-md-4"},P=(0,s.Lk)("label",null,"Selecione a Turma",-1),H=(0,s.Lk)("br",null,null,-1),O=(0,s.Lk)("option",{value:""},"Todas as Turmas",-1),V=["value"],W={class:"col-md-4"},R={class:"d-flex"},K=(0,s.Lk)("label",{class:"text-white"},".",-1),U=(0,s.Lk)("br",null,null,-1),B=(0,s.Lk)("span",{style:{"font-size":"22px"},class:"fas fa-search mx-1"},null,-1),D=(0,s.Lk)("label",{class:"text-white"},".",-1),q=(0,s.Lk)("br",null,null,-1),j=(0,s.Lk)("div",{class:"col-md-8 d-flex ps-2 pb-0"},null,-1),z=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{class:"bg-secondary"},[(0,s.Lk)("th",null,"NOME"),(0,s.Lk)("th",null,"IDENTIFICAÇÃO"),(0,s.Lk)("th",null,"TELEFONE"),(0,s.Lk)("th",null,"CURSO")])],-1),Q={class:"modal fade","data-bs-backdrop":"static",id:"registrationMultiple"},J={class:"modal-dialog modal-xl rounded-0"},Z={class:"modal-content rounded-0"},G={class:"modal-header"},Y=(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ee={class:"modal-body"},te={class:"row"},ae={class:"col-md-6"},se=(0,s.Lk)("h5",null,"Selecione os Estudantes",-1),le=(0,s.Lk)("input",{type:"text",class:"form-control mb-3",placeholder:"Pesquisar Estudantes (Filtro não implementado)"},null,-1),oe={style:{"max-height":"300px","overflow-y":"auto",border:"1px solid #eee",padding:"10px"}},de={class:"table table-striped table-sm"},ie=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Sel."),(0,s.Lk)("th",null,"Nome"),(0,s.Lk)("th",null,"Identificação")])],-1),ne=["value"],re={key:0},ce=(0,s.Lk)("td",{colspan:"3",class:"text-center"},"Nenhum estudante encontrado.",-1),ue=[ce],me={class:"col-md-6"},he={style:{"max-height":"300px","overflow-y":"auto",border:"1px solid #007bff",padding:"10px"}},pe={class:"list-group"},ke=["onClick"],_e={key:0,class:"list-group-item text-center text-muted"},be={class:"modal-footer border-0 pt-0"},fe=(0,s.Lk)("button",{class:"btn btn-secondary rounded-0","data-bs-dismiss":"modal"},"Fechar",-1),ge=["disabled"],Le={class:"modal fade","data-bs-backdrop":"static",id:"cancelRegistration"},ve={class:"modal-dialog rounded-0"},Ee={class:"modal-content rounded-0"},we={class:"modal-header"},Ce={class:"modal-body"},xe={class:"row"},ye={class:"modal-footer border-0 pt-0"},Fe=(0,s.Lk)("button",{class:"btn btn-secondary rounded-0","data-bs-dismiss":"modal"},"Fechar",-1);function Me(e,t,a,ce,Me,$e){const Se=(0,s.g2)("Sidebar"),Ae=(0,s.g2)("Navbar"),Te=(0,s.g2)("DataTable"),Xe=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",d,[(0,s.bF)(Se),(0,s.Lk)("div",i,[(0,s.bF)(Ae,{page:"Secretaria / Estudantes Matriculados"}),(0,s.Lk)("div",n,[(0,s.Lk)("div",r,[(0,s.Lk)("div",c,[(0,s.Lk)("div",u,[(0,s.Lk)("div",m,[(0,s.Lk)("div",h,[(0,s.Lk)("div",p,[(0,s.Lk)("div",k,[_,b,(0,s.bo)((0,s.Lk)("select",{class:"form-select","onUpdate:modelValue":t[0]||(t[0]=e=>Me.filter_data.ano_id=e)},[f,(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Me.anos,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nome),9,g)))),128))],512),[[o.u1,Me.filter_data.ano_id]])]),(0,s.Lk)("div",L,[v,E,(0,s.bo)((0,s.Lk)("select",{class:"form-select","onUpdate:modelValue":t[1]||(t[1]=e=>Me.filter_data.curso_id=e),onChange:t[2]||(t[2]=(...e)=>$e.getSalas&&$e.getSalas(...e))},[w,(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Me.cursos,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nome),9,C)))),128))],544),[[o.u1,Me.filter_data.curso_id]])]),(0,s.Lk)("div",x,[y,F,(0,s.bo)((0,s.Lk)("select",{class:"form-select","onUpdate:modelValue":t[3]||(t[3]=e=>Me.filter_data.periodo_id=e),onChange:t[4]||(t[4]=(...e)=>$e.getSalas&&$e.getSalas(...e))},[M,(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Me.periodos,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nome),9,$)))),128))],544),[[o.u1,Me.filter_data.periodo_id]])]),(0,s.Lk)("div",S,[A,T,(0,s.bo)((0,s.Lk)("select",{class:"form-select","onUpdate:modelValue":t[5]||(t[5]=e=>Me.filter_data.classe_id=e),onChange:t[6]||(t[6]=(...e)=>$e.getSalas&&$e.getSalas(...e))},[X,(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Me.classes,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nome),9,I)))),128))],544),[[o.u1,Me.filter_data.classe_id]])]),(0,s.Lk)("div",N,[P,H,(0,s.bo)((0,s.Lk)("select",{class:"form-select","onUpdate:modelValue":t[7]||(t[7]=e=>Me.filter_data.sala_id=e)},[O,(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Me.salas,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nome),9,V)))),128))],512),[[o.u1,Me.filter_data.sala_id]])]),(0,s.Lk)("div",W,[(0,s.Lk)("div",R,[(0,s.Lk)("div",null,[K,U,(0,s.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>$e.getMatriculados&&$e.getMatriculados(...e)),class:"btn btn-primary btn-sm mx-1 fw-bold d-flex align-items-center p-2 border-0 text-uppercase"},[B,(0,s.eW)(" Pesquisar ")])]),(0,s.Lk)("div",null,[D,q,(0,s.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>$e.getEstudantes&&$e.getEstudantes(...e)),style:{color:"black"},class:"btn btn-warning btn-sm mx-1 fw-bold d-flex align-items-center p-2 border-0 text-uppercase","data-bs-toggle":"modal","data-bs-target":"#registrationMultiple"}," Matricuar Vários ")])])]),j]),(0,s.bF)(Te,{ref:"table",data:Me.matriculados,columns:Me.columns,options:{select:!1,language:Me.language},class:"display table table-striped table-bordered"},{default:(0,s.k6)((()=>[z])),_:1},8,["data","columns","options"])])])])]),(0,s.Lk)("div",Q,[(0,s.Lk)("div",J,[(0,s.Lk)("div",Z,[(0,s.Lk)("div",G,[(0,s.Lk)("h4",null,"Matricular Vários Estudantes ("+(0,l.v_)(Me.selected_estudantes.length)+")",1),Y]),(0,s.Lk)("div",ee,[(0,s.Lk)("div",te,[(0,s.Lk)("div",ae,[se,le,(0,s.Lk)("div",oe,[(0,s.Lk)("table",de,[ie,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Me.estudantes,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[10]||(t[10]=e=>Me.selected_estudantes=e)},null,8,ne),[[o.lH,Me.selected_estudantes]])]),(0,s.Lk)("td",null,(0,l.v_)(e.nome),1),(0,s.Lk)("td",null,(0,l.v_)(e.identificacao),1)])))),128)),0===Me.estudantes.length?((0,s.uX)(),(0,s.CE)("tr",re,ue)):(0,s.Q3)("",!0)])])])]),(0,s.Lk)("div",me,[(0,s.Lk)("h5",null,"Estudantes a Matricular ("+(0,l.v_)($e.selectedEstudantesList.length)+")",1),(0,s.Lk)("div",he,[(0,s.Lk)("ul",pe,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)($e.selectedEstudantesList,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"list-group-item d-flex justify-content-between align-items-center py-1 px-2"},[(0,s.eW)((0,l.v_)(e.nome)+" ",1),(0,s.Lk)("span",{class:"badge bg-danger rounded-pill",style:{cursor:"pointer"},onClick:t=>$e.removeSelected(e.id)}," X ",8,ke)])))),128)),0===$e.selectedEstudantesList.length?((0,s.uX)(),(0,s.CE)("li",_e," Nenhum estudante selecionado. ")):(0,s.Q3)("",!0)])])])])]),(0,s.Lk)("div",be,[fe,(0,s.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>$e.matricularMultiplos&&$e.matricularMultiplos(...e)),disabled:0===Me.selected_estudantes.length||!Me.filter_data.ano_id||!Me.filter_data.curso_id||!Me.filter_data.sala_id||!Me.filter_data.periodo_id||!Me.filter_data.classe_id,class:"btn btn-primary rounded-0"}," Confirmar Matrículas ( "+(0,l.v_)(Me.selected_estudantes.length)+" ) ",9,ge)])])])]),(0,s.Lk)("div",Le,[(0,s.Lk)("div",ve,[(0,s.Lk)("div",Ee,[(0,s.Lk)("div",we,[(0,s.Lk)("h4",null,(0,l.v_)(Me.title),1)]),(0,s.Lk)("div",Ce,[(0,s.Lk)("div",xe,[(0,s.Lk)("p",null,[(0,s.eW)(" Deseja **remover permanentemente** esta matrícula de "),(0,s.Lk)("b",null,(0,l.v_)(Me.matricula.Estudante?Me.matricula.Estudante.nome:"o estudante"),1),(0,s.eW)("? Esta ação é irreversível. ")])])]),(0,s.Lk)("div",ye,[Fe,(0,s.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>$e.removerMatricula&&$e.removerMatricula(...e)),class:"btn btn-danger rounded-0"},"Remover Matrícula")])])])])]),(0,s.bF)(Xe)])])])}var $e=a(6587),Se=a.n($e),Ae=a(3362),Te=a(8808),Xe=a(6313),Ie=a(9715),Ne=a(903),Pe=a(9995),He=a(3786),Oe=a(782);Ne.A.use(Pe.A),Ne.A.use(He.A);var Ve={name:"matricula_view",components:{Sidebar:Ae.A,Navbar:Te.A,Footer:Xe.A,DataTable:Ne.A},data(){return{title:"Matrícula",dataTable:null,selectedRow:null,matriculados:[],estudantes:[],selected_estudantes:[],anos:[],cursos:[],periodos:[],salas:[],classes:[],estados:["Estudando","Cancelada","Transita","Não Transita"],matricula:{id:null,Estudante:{},estudante_id:""},filter_data:{ano_id:"",curso_id:"",sala_id:"",periodo_id:"",classe_id:""},columns:[{data:null,render:e=>null===e.Estudante?"Não definido":e.Estudante.nome},{data:null,render:e=>null===e.Estudante?"Não definido":e.Estudante.identificacao},{data:null,render:e=>null===e.Estudante?"Não definido":e.Estudante.telefone},{data:null,render:e=>`${e.Curso.nome}`}],language:Ie.BH}},mounted(){this.getEstudantes(),this.getAnos(),this.getCursos(),this.getPeriodos(),this.getClasses()},methods:{hideBootstrapModal(e){const t=document.getElementById(e);if(t&&window.bootstrap&&window.bootstrap.Modal){const e=window.bootstrap.Modal.getInstance(t)||new window.bootstrap.Modal(t);e.hide()}else console.warn(`Bootstrap Modal JS API não encontrada ou modal #${e} não existe. Tentando jQuery.`),"undefined"!==typeof Se()&&Se().fn.modal&&Se()(`#${e}`).modal("hide")},removeSelected(e){const t=this.selected_estudantes.indexOf(e);t>-1&&this.selected_estudantes.splice(t,1)},async matricularMultiplos(){if(!this.filter_data.ano_id||!this.filter_data.curso_id||!this.filter_data.sala_id||!this.filter_data.periodo_id||!this.filter_data.classe_id)return void this.$swal.fire({title:"Erro de Filtro",icon:"error",text:"Por favor, selecione **Ano, Curso, Período, Classe e Turma** para realizar as matrículas."});if(0===this.selected_estudantes.length)return void this.$swal.fire({title:"Atenção",icon:"warning",text:"Selecione pelo menos um estudante para matricular."});const e=this.selected_estudantes.map((e=>({ano_id:this.filter_data.ano_id,curso_id:this.filter_data.curso_id,sala_id:this.filter_data.sala_id,periodo_id:this.filter_data.periodo_id,classe_id:this.filter_data.classe_id,estudante_id:e,user_id:this.user.id,estado:"Estudando"}))),t={matriculas:e,user_id:this.user.id,nome:this.user.nome};try{const e=await Ie.FH.post("/matricula/multiple",t),a=e.data.message||`${this.selected_estudantes.length} Matrícula(s) realizada(s) com sucesso.`;this.$swal.fire({title:"Sucesso!",icon:"success",text:a}),this.selected_estudantes=[],this.hideBootstrapModal("registrationMultiple"),this.getMatriculados()}catch(a){console.error("ERRO COMPLETO na Matrícula Múltipla:",a);const e=a.response?.data?.message||"Erro ao matricular estudantes. Verifique o console.";this.$swal.fire({title:"Erro na Matrícula",icon:"error",text:e})}},async removerMatricula(){try{const e={user_id:this.user.id,nome:this.user.nome},t=await Ie.FH.delete(`/matricula/${this.matricula.id}`,{data:e});this.$swal.fire({title:t.data.message,icon:"success"}),this.getMatriculados(),this.hideBootstrapModal("cancelRegistration"),this.clearForm()}catch(e){const t=e.response?.data?.message||"Erro: Não foi possível excluir a matrícula.";this.$swal.fire({title:t,icon:"error"}),console.error("Erro ao remover matrícula:",e.response.data)}},getSalas(){const{periodo_id:e,curso_id:t,classe_id:a}=this.filter_data;if(!e||!t||!a)return this.salas=[],void(this.filter_data.sala_id="");Ie.FH.get(`/salas/curso/${t}/classe/${a}/periodo/${e}`).then((e=>{this.salas=e.data,0===this.salas.length&&(this.filter_data.sala_id="")})).catch((e=>{console.error("Erro ao carregar salas:",e),this.salas=[],this.filter_data.sala_id=""}))},generatePDF(){const{ano_id:e,curso_id:t,periodo_id:a,classe_id:s,sala_id:l}=this.filter_data;e&&t&&a&&s&&l?window.open(`${Ie.OZ}/api/documentos/lista-matriculados/ano/${e}/curso/${t}/periodo/${a}/classe/${s}/sala/${l}`,"_blank"):this.$swal.fire({title:"Filtros Incompletos",icon:"warning",text:"Por favor, selecione Ano, Curso, Período, Classe e Turma antes de gerar o PDF."})},getMatriculados(){const{ano_id:e,sala_id:t}=this.filter_data;if(!e||!t)return this.$swal.fire({title:"Filtros Obrigatórios",icon:"warning",text:"Por favor, selecione o Ano e a Turma para pesquisar os estudantes matriculados."}),void(this.matriculados=[]);Ie.FH.get(`/matricula/ano/${e}/turma/${t}/`).then((e=>{e.data&&e.data.length>0?this.matriculados=e.data:(this.matriculados=[],this.$swal.fire({title:"Notificação",icon:"warning",text:"Nenhum Estudante Matriculado Encontrado com os filtros selecionados."})),this.clearForm()})).catch((e=>{console.log(e),this.matriculados=[]}))},getEstudantes(){Ie.FH.get("/estudantes/").then((e=>{this.estudantes=e.data,this.selected_estudantes=[]})).catch((e=>{console.log(e)}))},getAnos(){Ie.FH.get("/anos/status/1/").then((e=>{this.anos=e.data})).catch((e=>{console.log(e)}))},getCursos(){Ie.FH.get("/cursos/").then((e=>{this.cursos=e.data})).catch((e=>{console.log(e)}))},getClasses(){Ie.FH.get("/classes/").then((e=>{this.classes=e.data})).catch((e=>{console.log(e)}))},getPeriodos(){Ie.FH.get("/periodos/").then((e=>{this.periodos=e.data})).catch((e=>{console.log(e)}))},selectRow(){const e=this.$refs.table.dt;this.matricula={id:null,Estudante:{}};const t=e.rows({selected:!0}).data();t.length>0&&(this.matricula=t[0])},clearForm(){this.matricula={id:null,Estudante:{},estudante_id:""},this.$refs.table&&this.$refs.table.dt&&this.$refs.table.dt.rows().deselect()}},computed:{...(0,Oe.aH)(["user"]),selectedEstudantesList(){return this.estudantes.filter((e=>this.selected_estudantes.includes(e.id)))}}},We=a(1241);const Re=(0,We.A)(Ve,[["render",Me]]);var Ke=Re}}]);
//# sourceMappingURL=385.acf70a9e.js.map